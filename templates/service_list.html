{% extends 'base.html' %}

{% load static %}

{% load crispy_forms_tags %}

{% block content %}

<head>
    <link rel="stylesheet" href="{% static 'css/service_list.css' %}">
    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>
    <script src="{% static 'js/service_typed.js' %}"></script>
</head>

<div class="container my-5">
    <!-- Animated Title -->
    <h1 class="text-center mb-4">
        <span id="typed-title"></span>
    </h1>

    <!-- Filter Type Heading -->
    <h2 class="text-center mb-4">
        {% if service_type == 'custom' %}
            Custom Services
        {% elif service_type == 'cloud' %}
            Cloud Services
        {% elif service_type == 'standard' %}
            Standard Services
        {% else %}
            All Services
        {% endif %}
    </h2>

    <!-- Service Cards -->
    <div class="row">
        {% for service in services %}
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm h-100">
                    {% if service.service_image %}
                        <img src="{{ service.service_image.url }}" class="card-img-top img-fluid" alt="{{ service.name }}">
                    {% else %}
                        <div class="card-img-top bg-secondary text-white text-center py-5">
                            <span>No Image Available</span>
                        </div>
                    {% endif %}
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">{{ service.name }}</h5>
                        <p class="card-text">{{ service.description|safe|truncatewords:20 }}</p>
                        <p class="card-text text-muted">${{ service.price }}</p>
                        <a href="{% url 'service_detail' service.id %}" class="btn btn-primary mt-auto">View Details</a>
                    </div>
                </div>
            </div>
        {% empty %}
            <p class="text-center col-12">No services available in this category.</p>
        {% endfor %}
    </div>
</div>

<script>
    // Typed.js for the animated title
    document.addEventListener("DOMContentLoaded", function() {
        const options = {
            strings: ["Explore Our Services", "Find Your Perfect Solution", "Innovate with Us"],
            typeSpeed: 50,
            backSpeed: 25,
            loop: true,
        };
        new Typed("#typed-title", options);
    });

    // Modal functionality
    document.addEventListener('DOMContentLoaded', () => {
        const serviceCards = document.querySelectorAll('.service-card');
        const modals = document.querySelectorAll('.service-modal');
        const closeButtons = document.querySelectorAll('.close');

        // Open modal on card click
        serviceCards.forEach(card => {
            card.addEventListener('click', () => {
                const serviceId = card.getAttribute('data-service-id');
                document.querySelector(`#modal-${serviceId}`).style.display = 'flex';
            });
        });

        // Close modal on button click
        closeButtons.forEach(button => {
            button.addEventListener('click', () => {
                const serviceId = button.getAttribute('data-service-id');
                document.querySelector(`#modal-${serviceId}`).style.display = 'none';
            });
        });

        // Close modal when clicking outside the content
        modals.forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });
        });
    });
</script>

{% endblock %}
